<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Manual Run Debug Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #00d4ff;
            padding-bottom: 20px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00d4ff, #7f00ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header p {
            color: #aaa;
            font-size: 1.1em;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .panel {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .panel:hover {
            border-color: rgba(0, 212, 255, 0.8);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
        }

        .panel h2 {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #00d4ff;
            border-bottom: 2px solid #00d4ff;
            padding-bottom: 10px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.95em;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: #aaa;
            font-weight: 500;
        }

        .stat-value {
            color: #00ff88;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }

        .bar-container {
            width: 100%;
            height: 24px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00d4ff);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .bar.danger {
            background: linear-gradient(90deg, #ff4444, #ff0000);
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        button {
            padding: 12px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #00d4ff, #0099cc);
            color: #000;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 212, 255, 0.3);
        }

        .btn-secondary {
            background: rgba(127, 0, 255, 0.4);
            color: #fff;
            border: 2px solid #7f00ff;
        }

        .btn-secondary:hover {
            background: rgba(127, 0, 255, 0.6);
            box-shadow: 0 0 15px rgba(127, 0, 255, 0.5);
        }

        .btn-danger {
            background: rgba(255, 68, 68, 0.3);
            color: #ff4444;
            border: 2px solid #ff4444;
        }

        .btn-danger:hover {
            background: rgba(255, 68, 68, 0.6);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .canvas-section {
            grid-column: 1 / -1;
        }

        #canvas-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 500px;
        }

        canvas {
            border: 2px solid #00d4ff;
            border-radius: 4px;
            background: #0a0a1a;
        }

        .wide {
            grid-column: 1 / 3;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 5px 0;
        }

        .status-active {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            border: 1px solid #00ff88;
        }

        .status-inactive {
            background: rgba(255, 68, 68, 0.2);
            color: #ff4444;
            border: 1px solid #ff4444;
        }

        .status-info {
            background: rgba(0, 212, 255, 0.2);
            color: #00d4ff;
            border: 1px solid #00d4ff;
        }

        .log-container {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            padding: 12px;
            height: 250px;
            overflow-y: auto;
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
            margin-top: 10px;
        }

        .log-entry {
            padding: 4px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .log-success {
            color: #00ff88;
        }

        .log-error {
            color: #ff4444;
        }

        .log-info {
            color: #00d4ff;
        }

        .log-warning {
            color: #ffaa00;
        }

        .input-group {
            margin: 10px 0;
        }

        label {
            display: block;
            color: #aaa;
            font-size: 0.9em;
            margin-bottom: 5px;
            font-weight: 500;
        }

        input[type="number"],
        input[type="range"],
        select {
            width: 100%;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 4px;
            color: #fff;
            font-family: inherit;
        }

        input[type="range"] {
            padding: 0;
            height: 6px;
        }

        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.2);
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid rgba(0, 212, 255, 0.2);
            color: #666;
            font-size: 0.9em;
        }

        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: 1fr 1fr;
            }

            .wide {
                grid-column: 1 / 3;
            }
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }

            .wide,
            .full-width {
                grid-column: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ Manual Run Debug Dashboard</h1>
            <p>Test & Debug des Canvas-Gameplays & Combat-Systems</p>
        </header>

        <div class="grid">
            <!-- HERO STATS -->
            <div class="panel wide">
                <h2>ü¶∏ Hero Status</h2>
                
                <div class="stat-row">
                    <span class="stat-label">Level</span>
                    <span class="stat-value" id="hero-level">1</span>
                </div>

                <div class="stat-row">
                    <span class="stat-label">Experience</span>
                    <span class="stat-value" id="hero-xp">0 / 100</span>
                </div>

                <div>
                    <label>HP</label>
                    <div class="bar-container">
                        <div class="bar" id="hero-hp-bar" style="width: 100%">100 / 100</div>
                    </div>
                </div>

                <div class="stat-row">
                    <span class="stat-label">‚öîÔ∏è Attack</span>
                    <span class="stat-value" id="hero-attack">10</span>
                </div>

                <div class="stat-row">
                    <span class="stat-label">üõ°Ô∏è Defense</span>
                    <span class="stat-value" id="hero-defense">5</span>
                </div>

                <div class="stat-row">
                    <span class="stat-label">‚ú® Crit Chance</span>
                    <span class="stat-value" id="hero-crit">5%</span>
                </div>

                <div class="stat-row">
                    <span class="stat-label">üí• Crit Damage</span>
                    <span class="stat-value" id="hero-crit-mult">2.0x</span>
                </div>
            </div>

            <!-- HERO CONTROLS -->
            <div class="panel">
                <h2>‚öôÔ∏è Hero Controls</h2>
                
                <div class="input-group">
                    <label>Level Adjustment</label>
                    <input type="number" id="hero-level-input" value="1" min="1" max="100">
                    <button class="btn btn-secondary" onclick="updateHeroLevel()">Update Level</button>
                </div>

                <div class="input-group">
                    <label>HP (Direct Set)</label>
                    <input type="number" id="hero-hp-input" value="100" min="0" max="1000">
                    <button class="btn btn-secondary" onclick="updateHeroHP()">Set HP</button>
                </div>

                <button class="btn btn-danger" onclick="resetHeroHP()" style="width: 100%; margin-top: 10px;">üîÑ Full Heal</button>
            </div>

            <!-- MONSTER CONTROLS -->
            <div class="panel">
                <h2>üëπ Monster Controls</h2>
                
                <div class="input-group">
                    <label>Monster HP</label>
                    <input type="number" id="monster-hp-input" value="50" min="0" max="500">
                    <button class="btn btn-secondary" onclick="updateMonsterHP()">Set HP</button>
                </div>

                <div class="input-group">
                    <label>Monster Type</label>
                    <select id="monster-type" onchange="changeMonsterType()">
                        <option value="goblin">üü¢ Goblin</option>
                        <option value="orc">üî¥ Orc</option>
                        <option value="dragon">üî• Dragon</option>
                        <option value="skeleton">‚ò†Ô∏è Skeleton</option>
                    </select>
                </div>

                <button class="btn btn-danger" onclick="spawnMonster()" style="width: 100%; margin-top: 10px;">Spawn Monster</button>
            </div>

            <!-- COMBAT SIM -->
            <div class="panel">
                <h2>‚öîÔ∏è Combat Simulator</h2>
                
                <div class="stat-row">
                    <span class="stat-label">Combat State</span>
                    <span class="stat-value" id="combat-state">Inactive</span>
                </div>

                <div class="controls">
                    <button class="btn btn-primary" onclick="heroAttack()">üéØ Hero Attack</button>
                    <button class="btn btn-secondary" onclick="heroDefend()">üõ°Ô∏è Defend</button>
                    <button class="btn btn-danger" onclick="monsterAttack()">üëπ Monster Attack</button>
                    <button class="btn btn-danger" onclick="endCombat()">End Combat</button>
                </div>
            </div>

            <!-- CANVAS RENDERING -->
            <div class="panel canvas-section">
                <h2>üé® Canvas Renderer Test</h2>
                
                <div class="controls">
                    <button class="btn btn-primary" onclick="initializeCanvas()">Initialize Canvas</button>
                    <button class="btn btn-secondary" onclick="testRendering()">Test Render</button>
                    <button class="btn btn-secondary" onclick="testAnimation()">Test Animation</button>
                </div>

                <div id="canvas-container"></div>
            </div>

            <!-- DEBUG LOG -->
            <div class="panel full-width">
                <h2>üìã Debug Log</h2>
                <div class="log-container" id="debug-log">
                    <div class="log-entry log-info">‚úÖ Debug dashboard initialized</div>
                </div>
                <button class="btn btn-secondary" onclick="clearLog()" style="width: 100%; margin-top: 10px;">Clear Log</button>
            </div>
        </div>

        <div class="footer">
            <p>Dungeon Idle Game Debug Dashboard | v1.0</p>
            <p>Use this tool to test and debug the manual run gameplay</p>
        </div>
    </div>

    <script>
        // Simple in-memory game state for testing
        let gameState = {
            hero: {
                level: 1,
                xp: 0,
                maxXp: 100,
                hp: 100,
                maxHp: 100,
                attack: 10,
                defense: 5,
                critChance: 0.05,
                critMultiplier: 2.0,
                x: 5,
                y: 5
            },
            monster: null,
            combat: {
                active: false,
                currentMonster: null
            }
        };

        const monsterTypes = {
            goblin: { name: 'Goblin', icon: 'üü¢', hp: 30, attack: 5, xp: 25, gold: 10 },
            orc: { name: 'Orc', icon: 'üî¥', hp: 50, attack: 8, xp: 50, gold: 25 },
            dragon: { name: 'Dragon', icon: 'üî•', hp: 150, attack: 15, xp: 200, gold: 100 },
            skeleton: { name: 'Skeleton', icon: '‚ò†Ô∏è', hp: 40, attack: 7, xp: 35, gold: 15 }
        };

        let canvas = null;
        let ctx = null;
        let animationId = null;

        // Logging function
        function log(message, type = 'info') {
            const logContainer = document.getElementById('debug-log');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            const timestamp = new Date().toLocaleTimeString();
            entry.textContent = `[${timestamp}] ${message}`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        function clearLog() {
            document.getElementById('debug-log').innerHTML = '';
            log('‚úÖ Log cleared', 'info');
        }

        // UI Update Functions
        function updateHeroUI() {
            const hero = gameState.hero;
            
            document.getElementById('hero-level').textContent = hero.level;
            document.getElementById('hero-xp').textContent = `${hero.xp} / ${hero.maxXp}`;
            document.getElementById('hero-attack').textContent = hero.attack;
            document.getElementById('hero-defense').textContent = hero.defense;
            document.getElementById('hero-crit').textContent = `${(hero.critChance * 100).toFixed(1)}%`;
            document.getElementById('hero-crit-mult').textContent = `${hero.critMultiplier.toFixed(1)}x`;
            
            const hpPercent = (hero.hp / hero.maxHp) * 100;
            const hpBar = document.getElementById('hero-hp-bar');
            hpBar.style.width = `${hpPercent}%`;
            hpBar.textContent = `${hero.hp} / ${hero.maxHp}`;
            hpBar.classList.toggle('danger', hpPercent < 30);
        }

        // Hero Controls
        function updateHeroLevel() {
            const newLevel = parseInt(document.getElementById('hero-level-input').value);
            gameState.hero.level = newLevel;
            gameState.hero.attack = 10 + (newLevel - 1) * 2;
            gameState.hero.defense = 5 + (newLevel - 1) * 1;
            gameState.hero.maxHp = 100 + (newLevel - 1) * 10;
            gameState.hero.hp = gameState.hero.maxHp;
            updateHeroUI();
            log(`‚úÖ Hero level updated to ${newLevel}`, 'success');
        }

        function updateHeroHP() {
            const newHp = parseInt(document.getElementById('hero-hp-input').value);
            gameState.hero.hp = Math.min(newHp, gameState.hero.maxHp);
            updateHeroUI();
            log(`‚úÖ Hero HP set to ${gameState.hero.hp}`, 'success');
        }

        function resetHeroHP() {
            gameState.hero.hp = gameState.hero.maxHp;
            document.getElementById('hero-hp-input').value = gameState.hero.maxHp;
            updateHeroUI();
            log(`üîÑ Hero fully healed`, 'success');
        }

        // Monster Controls
        function spawnMonster() {
            const type = document.getElementById('monster-type').value;
            const template = monsterTypes[type];
            
            gameState.monster = {
                ...template,
                maxHp: template.hp,
                x: 10,
                y: 5
            };
            
            gameState.combat.active = true;
            gameState.combat.currentMonster = gameState.monster;
            
            document.getElementById('combat-state').textContent = `‚öîÔ∏è Fighting ${template.name}`;
            log(`üëπ ${template.name} spawned with ${template.hp} HP`, 'warning');
            updateHeroUI();
        }

        function changeMonsterType() {
            const type = document.getElementById('monster-type').value;
            const template = monsterTypes[type];
            document.getElementById('monster-hp-input').value = template.hp;
        }

        function updateMonsterHP() {
            if (!gameState.monster) {
                log('‚ö†Ô∏è No monster spawned', 'warning');
                return;
            }
            const newHp = parseInt(document.getElementById('monster-hp-input').value);
            gameState.monster.hp = Math.max(0, newHp);
            log(`‚úÖ Monster HP set to ${gameState.monster.hp}`, 'success');
        }

        // Combat Simulation
        function heroAttack() {
            if (!gameState.monster) {
                log('‚ö†Ô∏è No monster to attack', 'warning');
                return;
            }

            const isCrit = Math.random() < gameState.hero.critChance;
            let damage = gameState.hero.attack;

            if (isCrit) {
                damage = Math.floor(damage * gameState.hero.critMultiplier);
                log(`‚ú® CRITICAL HIT! +${damage} damage!`, 'success');
            } else {
                log(`‚öîÔ∏è Hero attacks for ${damage} damage`, 'info');
            }

            gameState.monster.hp -= damage;
            if (gameState.monster.hp <= 0) {
                log(`‚úÖ Monster defeated! +${gameState.monster.xp} XP`, 'success');
                gameState.combat.active = false;
                document.getElementById('combat-state').textContent = 'Victory!';
            }
        }

        function heroDefend() {
            log('üõ°Ô∏è Hero defends (damage next turn reduced by 50%)', 'info');
        }

        function monsterAttack() {
            if (!gameState.monster) {
                log('‚ö†Ô∏è No monster to attack', 'warning');
                return;
            }

            const baseDamage = gameState.monster.attack;
            const defense = gameState.hero.defense;
            const damage = Math.max(1, baseDamage - defense);

            gameState.hero.hp -= damage;
            log(`üëπ ${gameState.monster.name} attacks for ${damage} damage!`, 'warning');

            if (gameState.hero.hp <= 0) {
                log('üíÄ Hero defeated!', 'error');
                gameState.combat.active = false;
                document.getElementById('combat-state').textContent = 'Defeat';
            }
            updateHeroUI();
        }

        function endCombat() {
            gameState.combat.active = false;
            gameState.monster = null;
            document.getElementById('combat-state').textContent = 'Inactive';
            log('üõë Combat ended', 'info');
        }

        // Canvas Functions
        function initializeCanvas() {
            const container = document.getElementById('canvas-container');
            container.innerHTML = '';
            
            canvas = document.createElement('canvas');
            canvas.width = 800;
            canvas.height = 500;
            ctx = canvas.getContext('2d');
            
            container.appendChild(canvas);
            log('‚úÖ Canvas initialized (800x500)', 'success');
        }

        function testRendering() {
            if (!ctx) {
                log('‚ö†Ô∏è Canvas not initialized. Click "Initialize Canvas" first.', 'warning');
                return;
            }

            // Clear
            ctx.fillStyle = '#0a0a1a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw dungeon floor
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(100, 100, 600, 300);

            // Draw grid
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)';
            ctx.lineWidth = 1;
            for (let x = 0; x <= 15; x++) {
                ctx.beginPath();
                ctx.moveTo(100 + x * 40, 100);
                ctx.lineTo(100 + x * 40, 400);
                ctx.stroke();
            }
            for (let y = 0; y <= 7; y++) {
                ctx.beginPath();
                ctx.moveTo(100, 100 + y * 40);
                ctx.lineTo(700, 100 + y * 40);
                ctx.stroke();
            }

            // Draw hero
            const heroX = 200;
            const heroY = 200;
            ctx.fillStyle = '#3498db';
            ctx.beginPath();
            ctx.arc(heroX, heroY, 15, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#fff';
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('ü¶∏', heroX, heroY);

            // Draw monster if exists
            if (gameState.monster) {
                const monsterX = 550;
                const monsterY = 200;
                ctx.fillStyle = '#e74c3c';
                ctx.beginPath();
                ctx.arc(monsterX, monsterY, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#fff';
                ctx.fillText(gameState.monster.icon, monsterX, monsterY);

                // HP Bar
                ctx.fillStyle = '#000';
                ctx.fillRect(monsterX - 30, monsterY - 35, 60, 8);
                ctx.fillStyle = '#2ecc71';
                const hpPercent = gameState.monster.hp / gameState.monster.maxHp;
                ctx.fillRect(monsterX - 30, monsterY - 35, 60 * hpPercent, 8);
            }

            // Draw treasure
            ctx.fillStyle = '#f1c40f';
            ctx.fillRect(600, 320, 40, 40);
            ctx.fillStyle = '#000';
            ctx.font = '24px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('üí∞', 620, 340);

            // Info panel
            ctx.fillStyle = 'rgba(26, 26, 46, 0.8)';
            ctx.fillRect(0, 0, 400, 80);
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`Floor 1 - Room 1/5`, 20, 25);
            ctx.fillText(`Status: ${gameState.monster ? '‚öîÔ∏è Combat' : 'üö™ Empty'}`, 20, 50);

            log('üé® Canvas render test completed', 'success');
        }

        function testAnimation() {
            if (!ctx) {
                log('‚ö†Ô∏è Canvas not initialized', 'warning');
                return;
            }

            if (animationId) cancelAnimationFrame(animationId);

            let frame = 0;
            const animate = () => {
                // Clear
                ctx.fillStyle = '#0a0a1a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Draw dungeon
                ctx.fillStyle = '#2c3e50';
                ctx.fillRect(100, 100, 600, 300);

                // Animated hero movement
                const heroX = 200 + Math.sin(frame * 0.05) * 50;
                const heroY = 200;
                ctx.fillStyle = '#3498db';
                ctx.beginPath();
                ctx.arc(heroX, heroY, 15, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = '#fff';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('ü¶∏', heroX, heroY);

                // Animated damage numbers
                ctx.fillStyle = '#ff4444';
                ctx.font = 'bold 20px Arial';
                ctx.fillText(`-${Math.floor(Math.sin(frame * 0.1) * 10 + 15)}`, heroX + 60, heroY - 50 - frame % 50);

                // Text
                ctx.fillStyle = '#fff';
                ctx.font = '14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`Frame: ${frame}`, 20, 25);

                frame++;
                if (frame < 200) {
                    animationId = requestAnimationFrame(animate);
                } else {
                    log('‚úÖ Animation test completed (200 frames)', 'success');
                }
            };

            animate();
            log('‚ñ∂Ô∏è Animation test started...', 'info');
        }

        // Initialize on load
        window.addEventListener('load', () => {
            updateHeroUI();
            log('üöÄ Debug dashboard ready!', 'success');
            log('1Ô∏è‚É£ Click "Initialize Canvas" to start', 'info');
        });
    </script>
</body>
</html>
